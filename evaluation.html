<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تقييم المواد | نظام مقياس</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="home.css"> 
    <link rel="stylesheet" href="evaluation.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* تحسينات سريعة لضمان عدم استطالة الصفحة */
        .main-content { padding: 20px; max-width: 1200px; margin: auto; }
        .evaluation-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* تقسيم الصفحة لنصفين */
            gap: 20px;
            align-items: start;
        }
        .compact-card { padding: 15px !important; margin-bottom: 0 !important; }
        .progress-grid { 
            display: grid; 
            grid-template-columns: 1fr; /* صف واحد داخل العمود */
            gap: 10px; 
        }
        .chart-container { height: 250px; position: relative; }
        
        @media (max-width: 992px) {
            .evaluation-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <nav class="side-nav">
        <div class="nav-logo">MQ</div>
        <ul class="nav-links">
            <li><a href="home.html"><i class="fas fa-home"></i> <span>الرئيسية</span></a></li>
            <li><a href="profile.html"><i class="fas fa-user-circle"></i> <span>معلوماتي</span></a></li>
            <li class="active"><a href="evaluation.html"><i class="fas fa-star"></i> <span>المواد</span></a></li>
            <li><a href="attendance.html"><i class="fas fa-calendar-check"></i> <span>الغياب</span></a></li>
            <li><a href="results.html"><i class="fas fa-poll-h"></i> <span>النتائج</span></a></li>
        </ul>
        <div class="nav-logout" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> <span>تسجيل الخروج</span></div>
    </nav>

    <main class="main-content">
        <header class="home-header" style="margin-bottom: 15px;">
            <div class="user-info">
                <h1 style="font-size: 1.6rem;">مركز التقييم الأكاديمي</h1>
            </div>
        </header>

        <div class="card compact-card animate-up" style="margin-bottom: 20px !important;">
            <div class="selection-bar" style="display: flex; gap: 15px; align-items: center;">
                <div style="flex: 2;">
                    <label style="font-size: 0.8rem; display: block; margin-bottom: 5px;">المادة الدراسية:</label>
                    <select id="subjectSelect" class="google-select" style="width: 100%; padding: 8px;">
                        <option value="Quran">القرآن الكريم</option>
                        <option value="Islamic">الدراسات الإسلامية</option>
                        <option value="Arabic">اللغة العربية</option>
                        <option value="Social">الدراسات الاجتماعية</option>
                        <option value="Math">الرياضيات</option>
                        <option value="Science">العلوم</option>
                        <option value="English">اللغة الإنجليزية</option>
                        <option value="Digital">المهارات الرقمية</option>
                        <option value="Art">التربية الفنية</option>
                        <option value="PE">التربية البدنية</option>
                        <option value="Life">المهارات الحياتية</option>
                        <option value="Critical" id="criticalOption" style="display:none;">التفكير الناقد</option>
                    </select>
                </div>
                <div style="flex: 1;">
                    <label style="font-size: 0.8rem; display: block; margin-bottom: 5px;">الأسبوع:</label>
                    <select id="weekSelect" class="google-select" style="width: 100%; padding: 8px;"></select>
                </div>
            </div>
        </div>

        <div id="dataContainer" class="evaluation-grid" style="display:none;">
            
            <div class="card compact-card animate-up">
                <h3 style="font-size: 1rem; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
                    <i class="fas fa-chart-bar"></i> تفاصيل درجات الأسبوع
                </h3>
                <div id="progressBarsContainer" class="progress-grid">
                    </div>
            </div>
            
            <div class="card compact-card animate-up" style="animation-delay: 0.1s;">
                <h3 style="font-size: 1rem; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
                    <i class="fas fa-line-chart"></i> تحليل الأداء التراكمي
                </h3>
                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
                <div id="aiFeedback" class="ai-feedback-box" style="margin-top: 15px; padding: 10px; font-size: 0.85rem; background: #f8faff;">
                    <p id="feedbackText" style="margin: 0;"></p>
                </div>
            </div>
        </div>

        <div id="noDataMessage" class="card animate-up" style="display:none; text-align:center; padding: 40px;">
            <i class="fas fa-folder-open" style="font-size: 3rem; color: #70757a; margin-bottom: 15px;"></i>
            <h3 style="color: #3c4043;">لا يوجد تقييم حالي</h3>
            <p style="color: #70757a; font-size: 0.9rem;">المعلم لم يرصد الدرجات لهذا الأسبوع بعد.</p>
        </div>
    </main>

    <script type="module" src="evaluation.js"></script>
</body>
</html>
